/* ==================== COVER ELEMENT STYLING ==================== */

/* Cover-top/bottom: aspect ratio using padding-top hack */
/* Cover-top: fixed aspect ratio using padding-top trick */
.dynamic-views .card.card-cover-top.image-format-cover .card-cover {
  width: 100%;
  height: 0;
  padding-top: calc(var(--dynamic-views-image-aspect-ratio, 0.55) * 100%);
  position: relative;
  overflow: hidden;
}

/* Cover-bottom: expands to fill remaining space */
.dynamic-views .card.card-cover-bottom.image-format-cover .card-cover {
  width: 100%;
  height: 100%;
  min-height: calc(var(--dynamic-views-image-aspect-ratio, 0.55) * 100%);
  position: relative;
  overflow: hidden;
}

/* Cover-bottom placeholder: expands to match cover dimensions */
.dynamic-views
  .card.card-cover-bottom.image-format-cover
  .card-cover-placeholder {
  height: 100%;
  min-height: calc(var(--dynamic-views-image-aspect-ratio, 0.55) * 100%);
}

/* Grid view: cover-bottom — fixed cover height */
.dynamic-views .dynamic-views-grid .card.card-cover-bottom .card-previews {
  flex-grow: 0;
}

/* Grid cover-bottom wrapper: fixed size, no margins (spacer handles top gap) */
.dynamic-views
  .dynamic-views-grid
  .card.card-cover-bottom.image-format-cover
  .card-cover-wrapper {
  flex-grow: 0;
  flex-shrink: 0;
  margin-top: 0;
  margin-bottom: 0;
}

/* Grid cover-bottom: push properties-bottom to bottom of card */
.dynamic-views
  .dynamic-views-grid
  .card.card-cover-bottom.image-format-cover
  .card-properties-bottom:not(:first-child) {
  margin-top: auto;
  padding-top: var(--size-4-2);
}

.dynamic-views
  .dynamic-views-grid
  .card.card-cover-bottom.image-format-cover
  .card-properties-bottom:only-child {
  margin-top: auto;
  padding-top: 0;
}

/* Grid cover-bottom: .card-content grows to push cover wrapper to bottom */

/* Compensate: card bottom padding = inset (instead of card-padding) */
.dynamic-views .dynamic-views-grid .card.card-cover-bottom.image-format-cover {
  padding-bottom: var(--cover-inset-computed);
}

.dynamic-views
  .dynamic-views-grid
  .card.card-cover-bottom.image-format-cover
  .card-cover {
  height: 0;
  min-height: 0;
  padding-top: calc(var(--dynamic-views-image-aspect-ratio, 0.55) * 100%);
}

.dynamic-views
  .dynamic-views-grid
  .card.card-cover-bottom.image-format-cover
  .card-cover-placeholder {
  height: 0;
  min-height: 0;
  padding-top: calc(var(--dynamic-views-image-aspect-ratio, 0.55) * 100%);
}

/* All covers: border radius */
.dynamic-views .card.image-format-cover .card-cover {
  border-radius: var(--dynamic-views-cover-border-radius, 0);
}

/* Circular cover: 50% makes any shape circular */
body.dynamic-views-cover-circular
  .dynamic-views
  .card.image-format-cover
  .card-cover-wrapper,
body.dynamic-views-cover-circular
  .dynamic-views
  .card.image-format-cover
  .card-cover,
body.dynamic-views-cover-circular
  .dynamic-views
  .card.image-format-cover
  .card-cover-placeholder {
  border-radius: 50%;
}

/* Cover-left/right: full height */
.dynamic-views .card.card-cover-left.image-format-cover .card-cover,
.dynamic-views .card.card-cover-right.image-format-cover .card-cover {
  width: 100%;
  height: 100%;
  position: relative;
  overflow: hidden;
}

/* Image element inside cover */
.dynamic-views .card.image-format-cover .card-cover .dynamic-views-image-embed {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
}

.dynamic-views .card.image-format-cover .card-cover img {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 1;
  object-fit: cover;
  object-position: center center;
  border-radius: 0; /* Override theme styles; container handles border-radius */
  opacity: 0;
  transition: opacity var(--anim-duration-fast, 140ms) ease;
}

.dynamic-views .card.image-format-cover.cover-ready .card-cover img {
  opacity: 1;
}

/* Skip image fade-in during shuffle (rearrange, not fresh load) */
.skip-cover-fade .card.image-format-cover .card-cover img,
.skip-cover-fade .card .card-thumbnail img,
.skip-cover-fade
  .card:is(.image-format-backdrop, .image-format-poster)
  :is(.card-backdrop, .card-poster)
  img {
  opacity: 1 !important;
  transition: none !important;
}

/* Hover zoom for cover images (desktop only).
   Default: "hover over card". The :not() fallback covers when Style Settings plugin is off. */
@media (hover: hover) {
  /* Base transition for single-image covers */
  body.dynamic-views-cover-hover-zoom-cover
    .dynamic-views
    .card.image-format-cover
    .card-cover:not(.card-cover-slideshow)
    .dynamic-views-image-embed
    img,
  body.dynamic-views-cover-hover-zoom-card
    .dynamic-views
    .card.image-format-cover
    .card-cover:not(.card-cover-slideshow)
    .dynamic-views-image-embed
    img,
  body:not(.dynamic-views-cover-hover-zoom-cover):not(
      .dynamic-views-cover-hover-zoom-card
    ):not(.dynamic-views-cover-hover-zoom-off)
    .dynamic-views
    .card.image-format-cover
    .card-cover:not(.card-cover-slideshow)
    .dynamic-views-image-embed
    img {
    transition:
      transform var(--anim-duration-fast, 140ms) ease,
      opacity var(--anim-duration-fast, 140ms) ease;
  }

  /* Base transition for slideshow covers - use scale property to not conflict with slide animations */
  body.dynamic-views-cover-hover-zoom-cover
    .dynamic-views
    .card.image-format-cover
    .card-cover-slideshow
    .dynamic-views-image-embed
    img,
  body.dynamic-views-cover-hover-zoom-card
    .dynamic-views
    .card.image-format-cover
    .card-cover-slideshow
    .dynamic-views-image-embed
    img,
  body:not(.dynamic-views-cover-hover-zoom-cover):not(
      .dynamic-views-cover-hover-zoom-card
    ):not(.dynamic-views-cover-hover-zoom-off)
    .dynamic-views
    .card.image-format-cover
    .card-cover-slideshow
    .dynamic-views-image-embed
    img {
    transition:
      scale var(--anim-duration-fast, 140ms) ease,
      opacity var(--anim-duration-fast, 140ms) ease;
  }

  /* Hover over cover: zoom when hovering cover element (single image) */
  body.dynamic-views-cover-hover-zoom-cover
    .dynamic-views
    .card.image-format-cover
    .card-cover:not(.card-cover-slideshow):hover
    .dynamic-views-image-embed
    img {
    transform: scale(1.05);
  }

  /* Hover over cover: zoom when hovering cover element (slideshow - only eligible image) */
  body.dynamic-views-cover-hover-zoom-cover
    .dynamic-views
    .card.image-format-cover
    .card-cover-slideshow:hover
    .dynamic-views-image-embed
    img.hover-zoom-eligible {
    scale: 1.05;
  }

  /* Hover over card: zoom when hovering anywhere on card (single image) */
  body.dynamic-views-cover-hover-zoom-card
    .dynamic-views
    .card.image-format-cover:hover
    .card-cover:not(.card-cover-slideshow)
    .dynamic-views-image-embed
    img,
  body:not(.dynamic-views-cover-hover-zoom-cover):not(
      .dynamic-views-cover-hover-zoom-card
    ):not(.dynamic-views-cover-hover-zoom-off)
    .dynamic-views
    .card.image-format-cover:hover
    .card-cover:not(.card-cover-slideshow)
    .dynamic-views-image-embed
    img {
    transform: scale(1.05);
  }

  /* Hover over card: zoom when hovering anywhere on card (slideshow - only eligible image) */
  body.dynamic-views-cover-hover-zoom-card
    .dynamic-views
    .card.image-format-cover:hover
    .card-cover-slideshow
    .dynamic-views-image-embed
    img.hover-zoom-eligible,
  body:not(.dynamic-views-cover-hover-zoom-cover):not(
      .dynamic-views-cover-hover-zoom-card
    ):not(.dynamic-views-cover-hover-zoom-off)
    .dynamic-views
    .card.image-format-cover:hover
    .card-cover-slideshow
    .dynamic-views-image-embed
    img.hover-zoom-eligible {
    scale: 1.05;
  }
}

/* ==================== COVER-CONTENT BORDER ==================== */

/* Border between cover and card content — inherits --card-border-color from card */
body.dynamic-views-show-cover-border
  .dynamic-views
  .card.card-cover-top.image-format-cover
  .card-cover-wrapper {
  border-bottom: 1px solid var(--card-border-color);
}
body.dynamic-views-show-cover-border
  .dynamic-views
  .card.card-cover-bottom.image-format-cover
  .card-cover-wrapper {
  border-top: 1px solid var(--card-border-color);
}
body.dynamic-views-show-cover-border
  .dynamic-views
  .card.card-cover-left.image-format-cover
  .card-cover-wrapper {
  border-right: 1px solid var(--card-border-color);
}
body.dynamic-views-show-cover-border
  .dynamic-views
  .card.card-cover-right.image-format-cover
  .card-cover-wrapper {
  border-left: 1px solid var(--card-border-color);
}

/* Transparent card border: cover-content divider stays visible using --hr-color */
body.dynamic-views-show-cover-border.dynamic-views-card-border-color-transparent
  .dynamic-views
  .card.image-format-cover
  .card-cover-wrapper {
  border-color: var(--background-modifier-border);
}
